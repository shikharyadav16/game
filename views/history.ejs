<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>NextScrimz | History</title>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@phosphor-icons/web@2.1.2/src/regular/style.css">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@phosphor-icons/web@2.1.2/src/bold/style.css">
    <link href="https://fonts.googleapis.com/css2?family=Nunito:wght@300;400;600;700;800;900&display=swap"
        rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link rel="stylesheet" href="/css/history.css">
  <link rel="icon" type="image/png" id="logo-header-main" href="/logo/logo.png">
</head>
<body>
    <!-- Header -->
    <%- include('./components/navbars/navbar-history.ejs', { wallet: wallet }) %>
        <%- include('./components/notify-card.ejs') %>
    <!-- Main Content -->
    <div class="container">
        <div class="page-header">
            <h1>History</h1>
            <p>Track your performance, analyze statistics, and review all your custom esports matches in one place.</p>
        </div>

        <!-- Stats Summary -->
        <div class="stats-summary">
            <div class="stat-card">
                <i class="fas fa-calendar-check stat-icon" style="color: var(--secondary);"></i>
                <div class="stat-value"><%= matchesPlayed %></div>
                <div class="stat-title">Matches Played</div>
            </div>
            <div class="stat-card">
                <i class="fas fa-crown stat-icon" style="color: var(--primary);"></i>
                <div class="stat-value"><%= rank %></div>
                <div class="stat-title">Global Ranking</div>
            </div>
            <div class="stat-card">
                <i class="fas fa-coins stat-icon" style="color: var(--warning);"></i>
                <div class="stat-value">Rs <%= totalWin %></div>
                <div class="stat-title">Total Earnings</div>
            </div>
            <div class="stat-card">
                <i class="ph ph-trend-up stat-icon" style="color: var(--danger); font-size: 52px;"></i>
                <div class="stat-value">Rs <%= maxWin %></div>
                <div class="stat-title">Most Earned in a Match</div>
            </div>
        </div>

        <!-- Matches Table -->
        <div class="matches-container">
            <div class="matches-header">
                <h2><i class="fas fa-history"></i> Recent Matches</h2>
            </div>


            <table class="matches-table">
  <thead>
    <tr>
      <th>Game</th>
      <th>Date & Time</th>
      <th>Team Size</th>
      <th>Entry Fee</th>
      <th>Prize Earned</th>
      <th>Status</th>
    </tr>
  </thead>
  <tbody>
    <% if (results && results.length > 0) { %>
      <% results.forEach(result => { %>
        <tr>
          <td>
            <div class="game-cell">
              <!-- Example icon + color mapping (you can expand this) -->
              <% 
                let iconClass = "";
                let bgColor = "";
                let textColor = "";
                switch (result.game.toLowerCase()) {
                  case "bgmi":
                    iconClass = "fas fa-crosshairs";
                    bgColor = "rgba(157, 45, 38, 0.2)";
                    textColor = "#9D2D26";
                    break;
                  case "ff":
                    iconClass = "fab fa-critical-role";
                    bgColor = "rgba(249, 58, 59, 0.2)";
                    textColor = "#F93A3B";
                    break;
                  default:
                    iconClass = "fas fa-gamepad";
                    bgColor = "rgba(100, 100, 100, 0.2)";
                    textColor = "#666";
                }
              %>
              <div class="game-icon" ">
                <i class="<%= iconClass %>"></i>
              </div>
              <div style="text-transform: uppercase;"><%= result.game %></div>
            </div>
          </td>
          <td>
            <!-- style="background:<%= bgColor %>; color:<%= textColor %>; -->
            <% 
              // format date & time from schema
              let formattedDate = new Date(result.date + "T" + (result.time || "00:00")).toLocaleString("en-US", { 
                month: "short", day: "numeric", year: "numeric", hour: "2-digit", minute: "2-digit" 
              });
            %>
            <%= formattedDate %>
          </td>
          <td><span class="team-size"><%= result.size || "-" %></span></td>
          <td class="entry-fee">Rs <%= result.entryFee.toFixed(2) %></td>
          <td class="prize-earned">Rs <%= result.prizeEarned.toFixed(2) %></td>
          <td>
            <span class="match-status <%= result.status === "WON" ? "status-won" : "status-lost" %>">
              <%= result.status %>
            </span>
          </td>
        </tr>
      <% }) %>
    <% } else { %>
      <tr>
        <td colspan="6" style="text-align:center;">No match results available</td>
      </tr>
    <% } %>
  </tbody>
</table>

        </div>
    </div>

    <!-- Footer -->
    <footer>
        <div class="footer-content">
            <div class="footer-section">
                <h3>NEXTSCRIMZ</h3>
                <p>Professional esports platform for competitive gamers. Join tournaments, track stats, and compete with the best.</p>
            </div>
            <div class="footer-section">
                <h3>Quick Links</h3>
                <ul class="footer-links">
                    <li><a href="/games"><i class="fas fa-home"></i> Games</a></li>
                    <li><a href="/leaderboard"><i class="fas fa-trophy"></i> Leaderboard</a></li>
                    <li><a href="/profile"><i class="fas fa-user"></i> Profile</a></li>
                </ul>
            </div>
            <div class="footer-section">
                <h3>Support</h3>
                <ul class="footer-links">
                    <li><a href="/help"><i class="fas fa-question-circle"></i> Help Center</a></li>
                    <li><a href="/contact"><i class="fas fa-envelope"></i> Contact Us</a></li>
                    <li><a href="/terms-of-service"><i class="fas fa-file-alt"></i> Terms of Service</a></li>
                    <li><a href="/privacy-policy"><i class="fas fa-lock"></i> Privacy Policy</a></li>
                </ul>
            </div>
        </div>
        <div class="copyright">
            &copy; 2025 NextScrimz. All rights reserved. Designed for competitive gamers.
        </div>
    </footer>
</body>
</html>